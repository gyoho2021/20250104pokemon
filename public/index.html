<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚±ãƒ¢ãƒ³ã‚¯ã‚¤ã‚º</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>ãƒã‚±ãƒ¢ãƒ³ã‚¯ã‚¤ã‚º</h1>

        <!-- åˆæœŸç”»é¢ï¼ˆèª¬æ˜ã¨ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ï¼‰ -->
        <div id="startScreen" class="start-screen">
            <p>ãƒã‚±ãƒ¢ãƒ³ã®åå‰ã‚’é€£ç¶šã§å½“ã¦ã¦ç§°å·ã‚’ã‚²ãƒƒãƒˆã—ã‚ˆã†ï¼</p>
            <button id="startButton">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>

        <!-- ã‚¯ã‚¤ã‚ºç”»é¢ -->
        <div id="quizScreen" class="quiz-screen" style="display: none;">
            <!-- ãƒã‚¤ãƒ³ãƒˆã¨ç§°å·ã‚’è¡¨ç¤º -->
            <div class="status">
                <p id="points">ãƒã‚±ãƒ¢ãƒ³ãƒã‚¤ãƒ³ãƒˆ: <span id="pointsValue">0</span></p>
                <p id="rank">ç¾åœ¨ã®ç§°å·: <span id="rankValue">ãªã—</span></p>
            </div>

            <!-- ãƒã‚±ãƒ¢ãƒ³ç”»åƒ -->
            <div class="image-container">
                <div id="placeholder" class="placeholder">?</div>
                <img id="pokemonImage" src="" alt="ãƒã‚±ãƒ¢ãƒ³ã®ç”»åƒ" style="display: none;">
            </div>

            <!-- é¸æŠè‚¢ -->
            <div class="options"></div>

            <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div class="message" id="message"></div>

            <!-- æ¬¡ã®å•é¡Œãƒœã‚¿ãƒ³ -->
            <button id="nextButton" style="display: none;">æ¬¡ã®å•é¡Œ</button>
        </div>

        <!-- ç§°å·ä¸€è¦§ -->
        <div class="ranks">
            <h2>ç§°å·ä¸€è¦§</h2>
            <ul>
                <li data-points="5ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank5">ãƒã‚±ãƒ¢ãƒ³åˆå¿ƒè€…</span></li>
                <li data-points="10ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank10">ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶</span></li>
                <li data-points="15ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank15">ã‚¸ãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼</span></li>
                <li data-points="20ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank20">ãƒãƒƒã‚¸ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼</span></li>
                <li data-points="25ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank25">ãƒã‚±ãƒ¢ãƒ³åšå£«è¦‹ç¿’ã„</span></li>
                <li data-points="30ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank30">ãƒã‚±ãƒ¢ãƒ³ç ”ç©¶å“¡</span></li>
                <li data-points="35ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank35">ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚¨ãƒªãƒ¼ãƒˆ</span></li>
                <li data-points="40ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank40">ã‚¸ãƒ ãƒªãƒ¼ãƒ€ãƒ¼å€™è£œ</span></li>
                <li data-points="45ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank45">ãƒã‚±ãƒ¢ãƒ³ãƒªãƒ¼ã‚°æŒ‘æˆ¦è€…</span></li>
                <li data-points="50ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank50">ãƒã‚±ãƒ¢ãƒ³ãƒã‚¹ã‚¿ãƒ¼è¦‹ç¿’ã„</span></li>
                <li data-points="55ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank55">ãƒã‚±ãƒ¢ãƒ³ã®é”äºº</span></li>
                <li data-points="60ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank60">ãƒã‚±ãƒ¢ãƒ³ãƒã‚¹ã‚¿ãƒ¼</span></li>
                <li data-points="65ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank65">ãƒã‚±ãƒ¢ãƒ³å°‚é–€å®¶</span></li>
                <li data-points="70ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank70">ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶</span></li>
                <li data-points="75ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank75">ãƒã‚±ãƒ¢ãƒ³ã®ä¼èª¬</span></li>
                <li data-points="80ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank80">ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³</span></li>
                <li data-points="85ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank85">ãƒã‚±ãƒ¢ãƒ³ã‚¨ãƒªãƒ¼ãƒˆ</span></li>
                <li data-points="90ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank90">ãƒã‚±ãƒ¢ãƒ³ã®ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰</span></li>
                <li data-points="95ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank95">ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ãƒã‚¹ã‚¿ãƒ¼</span></li>
                <li data-points="100ãƒã‚¤ãƒ³ãƒˆ"> <span id="rank100">ãƒã‚±ãƒ¢ãƒ³ã®ç¥</span></li>
            </ul>
        </div>
    </div>

    <script>
        let points = 0;
        let lastCorrect = true;

        const rankThresholds = [
            { points: 5, rank: "ãƒã‚±ãƒ¢ãƒ³åˆå¿ƒè€…" },
            { points: 10, rank: "ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶" },
            { points: 15, rank: "ã‚¸ãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼" },
            { points: 20, rank: "ãƒãƒƒã‚¸ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼" },
            { points: 25, rank: "ãƒã‚±ãƒ¢ãƒ³åšå£«è¦‹ç¿’ã„" },
            { points: 30, rank: "ãƒã‚±ãƒ¢ãƒ³ç ”ç©¶å“¡" },
            { points: 35, rank: "ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚¨ãƒªãƒ¼ãƒˆ" },
            { points: 40, rank: "ã‚¸ãƒ ãƒªãƒ¼ãƒ€ãƒ¼å€™è£œ" },
            { points: 45, rank: "ãƒã‚±ãƒ¢ãƒ³ãƒªãƒ¼ã‚°æŒ‘æˆ¦è€…" },
            { points: 50, rank: "ãƒã‚±ãƒ¢ãƒ³ãƒã‚¹ã‚¿ãƒ¼è¦‹ç¿’ã„" },
            { points: 55, rank: "ãƒã‚±ãƒ¢ãƒ³ã®é”äºº" },
            { points: 60, rank: "ãƒã‚±ãƒ¢ãƒ³ãƒã‚¹ã‚¿ãƒ¼" },
            { points: 65, rank: "ãƒã‚±ãƒ¢ãƒ³å°‚é–€å®¶" },
            { points: 70, rank: "ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶" },
            { points: 75, rank: "ãƒã‚±ãƒ¢ãƒ³ã®ä¼èª¬" },
            { points: 80, rank: "ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³" },
            { points: 85, rank: "ãƒã‚±ãƒ¢ãƒ³ã‚¨ãƒªãƒ¼ãƒˆ" },
            { points: 90, rank: "ãƒã‚±ãƒ¢ãƒ³ã®ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰" },
            { points: 95, rank: "ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ãƒã‚¹ã‚¿ãƒ¼" },
            { points: 100, rank: "ãƒã‚±ãƒ¢ãƒ³ã®ç¥" },
        ];

        const startScreen = document.getElementById('startScreen');
        const quizScreen = document.getElementById('quizScreen');
        const startButton = document.getElementById('startButton');

        const pokemonImage = document.getElementById('pokemonImage');
        const placeholder = document.getElementById('placeholder');
        const optionsContainer = document.querySelector('.options');
        const message = document.getElementById('message');
        const nextButton = document.getElementById('nextButton');
        const pointsDisplay = document.getElementById('points');
        const rankDisplay = document.getElementById('rank');

        startButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            quizScreen.style.display = 'block';
            loadQuiz();
        });

        async function loadQuiz() {
            message.textContent = '';
            optionsContainer.innerHTML = '';
            nextButton.style.display = 'none';

            placeholder.style.display = 'flex';
            pokemonImage.style.display = 'none';

            try {
                const response = await fetch('/pokemon/quiz');
                if (!response.ok) {
                    throw new Error(`HTTPã‚¨ãƒ©ãƒ¼! status: ${response.status}`);
                }
                const quizData = await response.json();

                pokemonImage.onload = () => {
                    placeholder.style.display = 'none';
                    pokemonImage.style.display = 'block';
                };

                pokemonImage.src = quizData.image;

                quizData.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'option';
                    button.addEventListener('click', () => checkAnswer(option, quizData.correct));
                    optionsContainer.appendChild(button);
                });
            } catch (error) {
                console.error("Fetchã‚¨ãƒ©ãƒ¼:", error);
                message.textContent = 'ã‚¯ã‚¤ã‚ºã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
                placeholder.style.display = 'none';
            }
        }

        function checkAnswer(selected, correct) {
    const buttons = document.querySelectorAll('.option');
    buttons.forEach(button => {
        button.disabled = true;
        if (button.textContent === correct) {
            button.classList.add('correct');
        } else {
            button.classList.add('incorrect');
        }
    });

    if (selected === correct) {
        if (!lastCorrect) {
            points = 1; // ãƒªã‚»ãƒƒãƒˆå¾Œã€å†ã‚¹ã‚¿ãƒ¼ãƒˆ
        } else {
            points++;
        }
        lastCorrect = true;
        updatePointsAndRank();
        message.textContent = 'æ­£è§£ï¼ğŸ‰';
    } else {
        lastCorrect = false;
        const comment = getCommentByPoints(points); // ãƒã‚¤ãƒ³ãƒˆã”ã¨ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—
        message.innerHTML = `
            ä¸æ­£è§£... æ­£è§£ã¯ã€Œ${correct}ã€ã§ã—ãŸ ğŸ˜¢<br>
            ã‚ãªãŸã®ä»Šå›ã®ãƒã‚¤ãƒ³ãƒˆã¯${points}ç‚¹ã§ã—ãŸï¼<br>
            <div class="comment">${comment}</div>
        `;
        points = 0; // ãƒªã‚»ãƒƒãƒˆ
        updatePointsAndRank();
    }

    nextButton.style.display = 'inline-block';
}


function updatePointsAndRank() {
    const pointsValue = document.getElementById('pointsValue');
    pointsValue.textContent = points;

    let currentRank = "ãªã—";
    for (let i = rankThresholds.length - 1; i >= 0; i--) {
        if (points >= rankThresholds[i].points) {
            currentRank = rankThresholds[i].rank;

            // ç§°å·ãŒãƒã‚¤ãƒ³ãƒˆã«é”ã—ãŸã‚‰è¡¨ç¤ºçŠ¶æ…‹ã‚’å¤‰æ›´
            const rankElement = document.getElementById(`rank${rankThresholds[i].points}`);
            if (rankElement && !rankElement.classList.contains('show')) {
                rankElement.classList.add('show'); // ç§°å·ã‚’è¡¨ç¤ºã™ã‚‹
            }
        }
    }

    const rankValue = document.getElementById('rankValue');
    rankValue.textContent = currentRank;
}


        function getCommentByPoints(points) {
            if (points <= 5) {
                return "ãƒã‚±ãƒ¢ãƒ³ã«ç–ã™ãã¾ã™ï¼ã“ã‚Œã‹ã‚‰å‹‰å¼·ã§ã™ã­ã€‚";
            } else if (points <= 10) {
                return "å°‘ã—ã¯çŸ¥ã£ã¦ã‚‹ã‘ã©ã€å­ã©ã‚‚ã«ã¯å‹ã¦ã¾ã›ã‚“ã­ã€‚";
            } else if (points <= 15) {
                return "æ˜”ã®è¨˜æ†¶ã«é ¼ã£ã¦ã¾ã™ã‹ï¼Ÿã‚‚ã£ã¨åŠªåŠ›ã—ã¾ã—ã‚‡ã†ï¼";
            } else if (points <= 20) {
                return "ãªã‹ãªã‹è‰¯ã„æ„Ÿã˜ã§ã™ï¼ã§ã‚‚ã¾ã ã¾ã ã§ã™ã‚ˆï¼";
            } else if (points <= 25) {
                return "å°‘ã—ãšã¤ä¸Šé”ã—ã¦ã¾ã™ã­ï¼ãƒã‚±ãƒ¢ãƒ³åšå£«ã¾ã§ã‚ã¨å°‘ã—ï¼";
            } else if (points <= 30) {
                return "ãƒã‚±ãƒ¢ãƒ³æ„›ãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã™ï¼ã‚‚ã£ã¨ä¸Šã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼";
            } else if (points <= 35) {
                return "ã™ã”ã„ï¼ä»¤å’Œã®ãƒã‚±ãƒ¢ãƒ³äº‹æƒ…ã«ã‚‚ã¤ã„ã¦ã„ã‘ã¦ã¾ã™ã­ï¼";
            } else if (points <= 40) {
                return "ã•ã™ãŒã§ã™ï¼ãƒã‚±ãƒ¢ãƒ³ãƒã‚¹ã‚¿ãƒ¼ãŒè¿‘ã¥ã„ã¦ãã¾ã—ãŸï¼";
            } else if (points <= 45) {
                return "ç›¸å½“è©³ã—ã„ã§ã™ã­ï¼ã‚‚ã†ãƒ—ãƒ­ç´šã®çŸ¥è­˜ã§ã™ï¼";
            } else if (points <= 50) {
                return "ã‚ãªãŸã¯ãƒã‚±ãƒ¢ãƒ³ã®é”äººã§ã™ï¼å‹é”ã«è‡ªæ…¢ã—ã¾ã—ã‚‡ã†ï¼";
            } else if (points <= 55) {
                return "ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶ã¨ã—ã¦æ¥ã˜ãªã„ç´ æ™´ã‚‰ã—ã„çŸ¥è­˜ã§ã™ï¼";
            } else if (points <= 60) {
                return "ã‚ãªãŸã®ãƒã‚±ãƒ¢ãƒ³çŸ¥è­˜ã¯è¦‹äº‹ã§ã™ï¼ã•ã‚‰ã«æ¥µã‚ã¦ãã ã•ã„ï¼";
            } else if (points <= 65) {
                return "ã“ã“ã¾ã§æ¥ã‚‹ã¨ãƒã‚±ãƒ¢ãƒ³ã®å°‚é–€å®¶ã¨è¨€ã£ã¦ã‚‚ã„ã„ã§ã—ã‚‡ã†ï¼";
            } else if (points <= 70) {
                return "çœŸã®ãƒã‚±ãƒ¢ãƒ³æ„›å¥½å®¶ã§ã™ã­ï¼ã“ã“ã¾ã§æ¥ãŸã‚‰ãƒã‚¹ã‚¿ãƒ¼ã‚’ç›®æŒ‡ãã†ï¼";
            } else if (points <= 75) {
                return "é©šãã¹ãçŸ¥è­˜é‡ï¼ã‚ãªãŸã¯ãƒã‚±ãƒ¢ãƒ³ç•Œã®ç”Ÿã‘ã‚‹ä¼èª¬ã§ã™ï¼";
            } else if (points <= 80) {
                return "ã“ã“ã¾ã§è©³ã—ã„ã¨ã¯â€¦ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³ã®é¢¨æ ¼ãŒæ¼‚ã£ã¦ã„ã¾ã™ï¼";
            } else if (points <= 85) {
                return "ã‚ãªãŸã¯ãƒã‚±ãƒ¢ãƒ³ç•Œã®ã‚¨ãƒªãƒ¼ãƒˆï¼æ¬¡ã¯ä¸–ç•Œä¸€ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼";
            } else if (points <= 90) {
                return "ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰ã®ç§°å·ã«ãµã•ã‚ã—ã„ç´ æ™´ã‚‰ã—ã„çŸ¥è­˜ã§ã™ï¼";
            } else if (points <= 95) {
                return "ã‚ãªãŸã®çŸ¥è­˜ã¯ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ãã®ã‚‚ã®ï¼ã¾ã•ã«ãƒã‚¹ã‚¿ãƒ¼ã§ã™ã­ï¼";
            } else {
                return "å®Œç’§ã§ã™ï¼ã‚ãªãŸã¯ãƒã‚±ãƒ¢ãƒ³ã®ç¥ã¨å‘¼ã°ã‚Œã‚‹ã«ãµã•ã‚ã—ã„å­˜åœ¨ã§ã™ï¼";
            }
        }

        nextButton.addEventListener('click', loadQuiz);
    </script>
</body>
</html>
